SET client_min_messages = ERROR;
SELECT spat_db_name(); -- spat-default
 spat_db_name 
--------------
 spat-default
(1 row)

-- switch to a new db
SET spat.db = 'test-spat';
SELECT spat_db_name(); -- test-spat
 spat_db_name 
--------------
 test-spat
(1 row)

SELECT spat_db_created_at() NOTNULL;
 ?column? 
----------
 t
(1 row)

-- switch back to the default to preserve my sanity when copy-pasting
SET spat.db = 'spat-default';
-- SET - DELETE - SIZE
SELECT spset('tkey1', 'dfgf');
 spset 
-------
 dfgf
(1 row)

SELECT spset('tkeygdfg1', 'dfgf');
 spset 
-------
 dfgf
(1 row)

SELECT spset('gdf', 'dfgf');
 spset 
-------
 dfgf
(1 row)

SELECT spset('gfd', 'dfgf');
 spset 
-------
 dfgf
(1 row)

SELECT sp_db_size(); --4
 sp_db_size 
------------
          4
(1 row)

-- DELETE and inspect size
SELECT del('tkey1'); --existing
 del 
-----
 t
(1 row)

SELECT del('aaaa'); --not existing
 del 
-----
 f
(1 row)

SELECT sp_db_size(); --3
 sp_db_size 
------------
          3
(1 row)

SELECT del('tkeygdfg1');
 del 
-----
 t
(1 row)

SELECT del('gdf');
 del 
-----
 t
(1 row)

SELECT del('gfd');
 del 
-----
 t
(1 row)

SELECT sp_db_size(); --0
 sp_db_size 
------------
          0
(1 row)

-- SET / GET / DEL text
SELECT spset('key1', 'value1');
 spset  
--------
 value1
(1 row)

SELECT spget('key1');
 spget  
--------
 value1
(1 row)

SELECT del('key1');
 del 
-----
 t
(1 row)

SELECT spget('key1');
 spget 
-------
 
(1 row)

-- SET / GET / DEL integer
SELECT spset('intkey1', 10);
 spset 
-------
 10
(1 row)

SELECT spget('intkey1');
 spget 
-------
 10
(1 row)

SELECT del('intkey1');
 del 
-----
 t
(1 row)

SELECT spget('intkey1');
 spget 
-------
 
(1 row)

